<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Password Strength Checker - SafeZone</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 0 20px; color:#111; }
    h1 { color:#1a73e8; }
    input[type=password]{ padding:8px; width:60%; margin-right:8px; }
    button{ padding:8px 12px; }
    .card{ background:#f7f9fc; padding:16px; border-radius:8px; margin-top:20px; }
    .strong{ color:green; font-weight:700; }
    .weak{ color:red; font-weight:700; }
    ul{ margin-top:8px; }
    pre{ background:#eee; padding:10px; border-radius:6px; overflow:auto; }
    #pw-meter { height:10px; background:#eee; border-radius:6px; overflow:hidden; margin-top:10px; }
    #pw-meter-bar { height:100%; width:0%; background:#e74c3c; transition:width 0.3s; }
    #pw-score { margin-top:6px; font-weight:600; }
    #pw-feedback { margin-top:6px; color:#333; }
  </style>
</head>
<body>
  <h1>SafeZone — Password Strength Checker</h1>
  <p>Type a password to evaluate its strength. This tool helps you learn how to create stronger passwords.</p>

  <form method="post" autocomplete="off">
    <input type="password" name="password" placeholder="Enter password to check" required>
    <button type="submit">Check</button>
  </form>

  <!-- Client-side meter -->
  <div id="pw-meter">
    <div id="pw-meter-bar"></div>
  </div>
  <div id="pw-score"></div>
  <ul id="pw-feedback"></ul>

  {% if result %}
  <div class="card">
    <h3>Server-side Result: <span class="{{ 'strong' if result.score_pct>=60 else 'weak' }}">{{ result.strength }}</span></h3>
    <p><strong>Score:</strong> {{ result.score_pct }}% ({{ result.points }} points)</p>
    <p><strong>Length:</strong> {{ result.length }} characters — Unique characters: {{ result.unique_chars }}</p>
    <p><strong>Contains:</strong>
      {% if result.lower %} lower {% endif %}
      {% if result.upper %} upper {% endif %}
      {% if result.digit %} digit {% endif %}
      {% if result.special %} special {% endif %}
    </p>
    {% if result.suggestions %}
    <h4>Suggestions to improve:</h4>
    <ul>
      {% for s in result.suggestions %}
      <li>{{ s }}</li>
      {% endfor %}
    </ul>
    {% endif %}
  </div>
  {% endif %}

  <hr>
  <p>Project by <strong>Surijiddinov Xudoyor</strong> — part of SafeZone cyber demos. See source on GitHub.</p>

  <!-- zxcvbn library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/zxcvbn/4.4.2/zxcvbn.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const pwInput = document.querySelector('input[name="password"]');
      const bar = document.getElementById('pw-meter-bar');
      const scoreEl = document.getElementById('pw-score');
      const feedbackEl = document.getElementById('pw-feedback');

      function updateMeter() {
        const val = pwInput.value || '';
        const res = zxcvbn(val);
        const score = res.score; // 0..4
        const pct = (score / 4) * 100;

        bar.style.width = pct + '%';

        if (score <= 1) bar.style.background = '#e74c3c';
        else if (score == 2) bar.style.background = '#f39c12';
        else if (score == 3) bar.style.background = '#27ae60';
        else bar.style.background = '#2ecc71';

        const scoreText = ['Very weak','Weak','Fair','Strong','Very strong'][score];
        scoreEl.innerText = `Strength: ${scoreText} (${pct}%)`;

        feedbackEl.innerHTML = '';
        if (res.feedback && res.feedback.suggestions) {
          res.feedback.suggestions.forEach(s => {
            const li = document.createElement('li');
            li.innerText = s;
            feedbackEl.appendChild(li);
          });
        }
      }

      pwInput.addEventListener('input', updateMeter);
    });
  </script>
</body>
</html>
